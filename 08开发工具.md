#  十一、开发工具

### 1. 什么是code review？

代码评审也称代码复查，是指通过阅读代码来检查源代码与编码标准的符合性以及代码质量的活动。流程和规则，通常采用Git Flow + Pull Request（PR）模式来做Code Review。

### 2. 如何发布和回滚，用jenkins又是怎么实现？

 

### 3. 如何测系统的QPS?

[ 面试官之问：知道你的接口“QPS”是多少吗](https://zhuanlan.zhihu.com/p/84012183)

**QPS（Query Per Second）：每秒请求数，就是说服务器在一秒的时间内处理了多少个请求。**

可以通过分析访问日志来了解系统的QPS。









## 1. Github Page

### 1.1 使用Jekyll 和 Github Page写个人博客

TODO

(Github Page文档)[https://docs.github.com/en/github/working-with-github-pages/setting-up-a-github-pages-site-with-jekyll]

1. 安装ruby



```shell
# 安装ruby
sudo yum install ruby
# 安装bundler
gem install bundler
# 由于墙的原因，这一步会非常慢，所以要先修改gem的源

# 查看现在的gem源
gem sources
# 移除gem源
gem sources --remove https://rubygems.org/
# 添加新的gem源
gem sources -a https://mirrors.aliyun.com/rubygems/
```





## 2. Git

### Github加速工具

https://gitee.com/docmirror/dev-sidecar



最近使用git，Github通过邮件提示不推荐用`accunt/password`方式了，推荐使用`SSH`方式。内容如下：

```email
[GitHub] Deprecation Notice
1封邮件
GitHub <noreply@github.com> 2021年3⽉8⽇周⼀ 23:21
收件⼈： CabbageDog13 <497245423@qq.com>

  Hi @sjl-is-big-idiot,

  You recently used a password to access the repository at sjl-is-big-idiot/sjl-is-big-idiot.github.io with git using
git/1.8.3.1.
  Basic authentication using a password to Git is deprecated and will soon no longer work. Visit
https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/ for more information around
suggested workarounds and removal dates.


Thanks,
The GitHub Team
```

这个的意思是我么在`push`或`pull`之类的时候，不要用`https://github.com/xxxx`了，因为这样就是走`account/password`了，

![image-20210322220828616](08开发工具.assets/image-20210322220828616.png)

需要用`git@github.com:xxxx`，这样就是走`SSH`协议了，使用的是你之前在`Github`中配置的公钥。

![image-20210322220852792](08开发工具.assets/image-20210322220852792.png)



### 2.1 使用github托管我的个人网站

情景

> 因为之前使用Github page做了一个个人网站，sjl-is-big-idiot.io 这个网站，现在需要发布新的博客，所以需要在一个新创建的虚拟机中pull这个仓库的代码，因此下面写出实现的步骤。

1. 设置git的用户名和邮箱。`--global`表示本机所有git仓库都用这个配置，也可不同仓库使用不同的用户名和邮箱，具体的看`git config`的使用方式。

   ```shell
   git config --global user.name "sjl"
   git config --global user.email "jlsuncugb@163.com"
   ```

2. 创建目录，存放仓库。

   ```shell
   mkdir myProjects
   cd myprojects
   ```

3. 配置本地仓库与Github远程仓库的SSH加密传输

   ```shell
   # 1. 生成SSH公钥和私钥，如果已经有了可以跳过此步骤
   # 查看是否已有SSH公钥和私钥
   ll ~/.ssh
   # 没有的话，执行如下命令创建SSH公钥和私钥。
   ssh-keygen -t rsa -C "jlsuncugb@163.com"
   
   # 2. 登陆GitHub，打开“Account settings”，“SSH Keys”页面：
   # 然后，点“Add SSH Key”，填上任意Title，在Key文本框里粘贴id_rsa.pub文件的内容：
   ```

   

4. 添加远程仓库。

   ```shell
   # 1.登录Github创建一个仓库，这种情境下，就用我们个人网站这个仓库即可
   # 2.关联到远程仓库
   git remote add origin  https://github.com/sjl-is-big-idiot/sjl-is-big-idiot.github.io.git
   # 或者
   git remote add origin git@github.com:sjl-is-big-idiot/sjl-is-big-idiot.github.io.git
   ```

   ![personal-website repository](08开发工具.assets/image-20210308210742301.png)

   

5. 从Github中clone该个人网站的源代码。

   ```shell
   git clone https://github.com/sjl-is-big-idiot/sjl-is-big-idiot.github.io.git
   ```

6. 接下来开始更新博客。

   balabala

7. 将更新后的代码推送到Github中对应的仓库。

   ```shell
   # 将工作区内容，添加到暂存区
   git add .
   # 将暂存区内容提及到本地仓库
   git commit -m "add xx blog"
   # 将本地仓库内容，推送到Github上对应仓库的master分支
   [root@prometheus sjl-is-big-idiot.github.io]# git push origin master
   Username for 'https://github.com': 497245423@qq.com
   Password for 'https://497245423@qq.com@github.com': 
   Counting objects: 6, done.
   Delta compression using up to 4 threads.
   Compressing objects: 100% (4/4), done.
   Writing objects: 100% (4/4), 2.03 KiB | 0 bytes/s, done.
   Total 4 (delta 2), reused 0 (delta 0)
   remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
   remote: 
   remote: GitHub found 2 vulnerabilities on sjl-is-big-idiot/sjl-is-big-idiot.github.io's default branch (1 high, 1 low). To find out more, visit:
   remote:      https://github.com/sjl-is-big-idiot/sjl-is-big-idiot.github.io/security/dependabot
   remote: 
   To https://github.com/sjl-is-big-idiot/sjl-is-big-idiot.github.io.git
      98968de..0f31d6d  master -> master
   
   ```





## 3. Visual Studio Code

[Visual Studio Code 官方文档](https://code.visualstudio.com/docs/python)

[Vscode 小白使用介绍](https://www.cnblogs.com/tu-0718/p/10935910.html)

### 3.1 VSCode 代码片段配置

其实，也有好多插件可以实现，条条大路通罗马，撸起袖子干就完事了。

#### 3.1.1 配置Python文件头

例子，配置Python 文件头（即文件作者，时间，等描述信息）；

1. 打开VSCode
2. File > Preferences > User Snippets > 选择python

![img](08开发工具.assets/GYC6[`2_HPC5DBX9QT_LWD2.png)

将以下内容添加到这个`json`文件中。

```json
    "HEADER":{
        "prefix": "pyHeader",
        "body": [
			"#!/usr/bin/env python",
			"# -*- encoding: utf-8 -*-",
			"'''",
			"@File    :   $TM_FILENAME",
			"@Date    :   $CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE $CURRENT_HOUR:$CURRENT_MINUTE:$CURRENT_SECOND",
			"@Author  :   sjl ",
			"@Version :   1.0",
			"@Email   :   jlsuncugb@163.com",
			"@License :   None",
			"@Desc    :   None",
			"@Last Modified by:   sjl",
			"@Last Modified time: $CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE $CURRENT_HOUR:$CURRENT_MINUTE:$CURRENT_SECOND",
			"'''",
			"",
			"# here put the import lib",
			"$0"
	    ],
	}
```

在写Python脚本时，输入pyHeader效果如下：

![image-20210310201927396](08开发工具.assets/image-20210310201927396.png)

再回车，就直接出来了设置好的文件头了，十分方便。

![image-20210310201941381](08开发工具.assets/image-20210310201941381.png)



#### 3.1.2 配置HTML代码

首先，比较简洁的标准的HTML代码，不用设置，VSCode自带快捷设置。

创建一个`.html`文件，输入`!`，然后按`TAB`键就出来了。

配置HTML 代码也是类似的，File > Preferences > User Sinnepts > html.json ，添加如下代码：

```html
"html5 demo": {
		"prefix": "!5",   // 这个是你输入的快捷代码
		"body": [// 这里是插入的内容
			"<!DOCTYPE html>",
			"<html lang='en'>",
			"<head>",
				"\t<meta charset='UTF-8'>",
				"\t<meta name='referrer' content='always'>",
				"\t<meta name='author' content='sjl'>",
				"\t<meta name='robots' content='none'>",
				"\t<meta name='keywords' content=''>",
				"\t<meta name='description' content=''>",
				"\t<meta name='renderer' content='webkit'>",
				"\t<meta name='revisit-after' content='7 days' >",
				"\t<meta http-equiv=widow-target Content=_top>",
			    "\t<meta name='viewport' content='width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no, shrink-to-fit=no' viewport-fit=cover />",
			    "\t<meta http-equiv='X-UA-Compatible' content='ie=edge,chrome=1'>",
				"\t<title>$1</title>",  // 光标首次会在$1 的地方，按tab 会跳到 $2
				"\t<style>",
					"\t\t *{",
						"\t\t\tmargin:0;",
						"\t\t\tpadding:0;",
						"\t\t\tbox-sizing:border-box;",
						"\t\t\t-webkit-tap-highlight-color:transparent;",
					"\t\t}",
				"\t</style>",
			"</head>",
			"<body>",
			    "\t$2",
			"</body></html>"
		],
		"description": "html5 专用 create by sjl"  // 这里是你的快捷输入的时候 VS code 提示的文字
	}
```

### 3.2 VSCode配置markdown插件

点击左侧的 extensions > 搜索"markdown"，在这里我用的是"Markdown All in One"这个插件，具体使用方法，也都写的有，咱直接安装就行了。 

![image-20210310203240593](08开发工具.assets/image-20210310203240593.png)

创建一个`.md`文件，点击右方的图标可以，查看`markdown`的效果。

![image-20210310204112365](08开发工具.assets/image-20210310204112365.png)

剩下的就自己探索吧。

### 3.3 VSCode 使用pylint

[Visual Studio Code官方文档-linting](https://code.visualstudio.com/docs/python/linting)

1. 安装pylint包。

   ```python
   pip3 install pylint
   ```

   比如，我是通过`anaconda`来作为包管理器/环境管理器，那么也可以通过`anaconda`来安装`pylint`。

   ```shell
   C:\Users\sjl>conda env list
   # conda environments:
   #
   base                  *  C:\Users\sjl\Anaconda3
   django                   C:\Users\sjl\Anaconda3\envs\django
   learnpython              C:\Users\sjl\Anaconda3\envs\learnpython
   myscrapy                 C:\Users\sjl\Anaconda3\envs\myscrapy
   
   C:\Users\sjl>conda activate learnpython
   
   (learnpython) C:\Users\sjl>pip3
   (learnpython) C:\Users\sjl>pip3 install pylint
   ```

   

## 4. Gitlib + Jenkins



## 5. xshell



### 5.1 `xshell` 按了`ctrl + s` 导致`xshell`假死怎么办？

`ctrl + q`



## 6. VMware

### 6.1 VMware文件过大，导致C盘过大

VMware的虚拟机文件默认存放在`C:\Users\sjl\Documents\Virtual Machines\`目录下，只需要将下面的文件放到`D:\Virtual Machines\`目录下，然后在 VMware`文件 > 打开 > xxx.vmx` 即可。

### 6.2 VMware虚拟机和宿主机可以相互ping通，但是宿主机无法访问虚拟机中开启的服务

宿主机 -> 虚拟机 能ping通

虚拟机 -> 宿主机 能ping通

这说明ip是没有问题的，可能是因为没有开放端口导致的服务无法访问。

1. 检查windows10的防火墙是否开启，需要关闭。检查发现已经关闭了。

2. 检查虚拟机的防火墙是否开启。发现虚拟机防火墙已经关闭了。

   ```shell
   # 查看firewalld状态， 结果显示inactive，未开启。
   systemctl status firewalld
   # 查看iptables状态
   systemctl status iptables
   Unit iptables.service could not be found.
   ```

3. 启动虚拟机的firewalld，并开放指定端口。

   ```shell
   systemctl start firewalld
   systemctl status firewalld
   
   # 添加防火墙规则
   firewall-cmd --zone=public --list-ports
   firewall-cmd --zone=public --add-port=7474/tcp --permanent
   # 每次更改firewall规则后，需要重新加载，获取重启firewalld才能生效
   firewall-cmd --zone=public --reload
   或
   sytemctl restart firewalld
   
   # 其他命令
   # 查看版本： 
   firewall-cmd --version
   
   # 查看帮助： 
   firewall-cmd --help
   
   # 显示状态： 
   firewall-cmd --state
   
   # 查看所有打开的端口： 
   firewall-cmd--zone=public --list-ports
   
   # 查看所有配置的规则
   firewall-cmd --list-all
   
   # 更新防火墙规则： 
   firewall-cmd --reload
   
   # 查看区域信息:  
   firewall-cmd--get-active-zones
   
   # 查看指定接口所属区域： 
   firewall-cmd--get-zone-of-interface=eth0
   
   # 拒绝所有包：
   firewall-cmd --panic-on
   
   # 取消拒绝状态： 
   firewall-cmd --panic-off
   
   # 查看是否拒绝： 
   firewall-cmd --query-panic
   
   
   # 添加,（--permanent永久生效，没有此参数重启后失效）
   firewall-cmd --zone=public --add-port=80/tcp --permanent
   # 对指定ip，开放指定端口
   firewall-cmd --permanent --add-rich-rule="rule family="ipv4" source address="x.x.x.x" port protocol="tcp" port="7474" accept"
   
   # 重新载入
   firewall-cmd --reload
   
   # 查看
   firewall-cmd --zone=public --query-port=80/tcp
   
   # 删除开发的端口
   firewall-cmd --zone=public --remove-port=80/tcp --permanent
   
   # 删除 rich-rule
   firewall-cmd --permanent --remove-rich-rule="rule family="ipv4" source address="x.x.x.x" port protocol="tcp" port="7474" accept"
   ```

   

![image-20210407174746112](08开发工具.assets/image-20210407174746112.png)



> 至于为什么虚拟机的防火墙都没开，却不能访问其端口，这个还不清楚。





## 7. vim简单配置

```vimrc
set nocompatible
syntax on
set showmode
set showcmd
set mouse=a
set encoding=utf-8  
set t_Co=256
filetype indent on
set autoindent
set tabstop=2
set shiftwidth=4
set expandtab
set softtabstop=2
set number
set relativenumber
set cursorline
set textwidth=80
set wrap
set nowrap
set linebreak
set wrapmargin=2
set scrolloff=5
set sidescrolloff=15
set laststatus=2
set  ruler
set showmatch
set hlsearch
set incsearch
set ignorecase
set smartcase
set spell spelllang=en_us
set nobackup
set noswapfile
set undofile
set backupdir=~/.vim/.backup//  
set directory=~/.vim/.swp//
set undodir=~/.vim/.undo// 
set autochdir
set noerrorbells
set visualbell
set history=1000
set autoread
set listchars=tab:»■,trail:■
set list
set wildmenu
set wildmode=longest:list,full
```

